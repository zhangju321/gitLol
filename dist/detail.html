<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src ="js/cart.js"></script>
    <script src="./js/jquery-1.11.0.js"></script>
    <title>详情页</title>
    <style>
        ul{
            width: 400px;
            height: 800px;
        }
        ul,li{
            list-style: none;
        }
        li p{
            width: 218px;
        }      
         li .btn{
            border: none;
            width: 220px;
            height: 40px;
            background-color: red;
            color: white;
            cursor: pointer;
            text-align: center;
        }
        .minus{
            cursor:pointer;
            background: greenyellow;
            width: 24px;
        }
        .plus{  
            cursor: pointer;
            background: greenyellow;
            width: 24px;
        }
        .txt{           
            width: 160px;
        }
        .title{
            text-align: center;
            font-size: 30px;
            color: green;
            margin: 0;
            border-right: 1px solid red;
            border-left: 1px solid red;
        }
        .price{
            text-align: center;
            border: 1px solid red;  
            margin: 0;
        }
        .jiajian{
            width: 218px;
            text-align: center;
            border-right: 1px solid red;
            border-left: 1px solid red;
            margin: 0;
            display: flex;
            justify-content: space-between;
        }
       
    </style>
</head>
<body>
    <ul class="detail">
      
    </ul>
</body>
<script>
    let aaa = location.search;
    var bbb = aaa.split("?pid=");    
    $.get("http://jx.xuzhixiang.top/ap/api/productlist.php", {
                uid: 16911
            },    
            (data) => {            
                var shu = data.data;
                var str = "";           
               for(var i in shu){
                if(bbb[1] == shu[i].pid){
       str+=`  <li>
            <img src="${shu[i].pimg}" alt="">
            <p class ="title">${shu[i].pname}</p>
            <p class="price">${shu[i].pprice}</p>
            <p class="jiajian">
                <span class="minus"> - </span>
            <input type ="text" class= "txt" value="1">
               <span class="plus"> + </span>
            </p>  
           <a href="car.html"><input type="button" class="btn" data-id = "${shu[i].pid}" value="加入购物车"/></a>
         </li>`;
        }
     }
    $('.detail').html(str);
    
    $(function(){
        var result = $('.txt').val();  
        $('.minus').click(function(){   
            if(result <= 1){
                result = 1;
                return;
            }
            $('.txt').val(--result);
        });
        $('.plus').click(function(){       
           var res = $('.txt').val(++result); 
           var ccc = res.val();
            // console.log(ccc);
           return ccc;
        });
        console.log($('.plus'));
       
   let cart = new Cart();
   var $btn = $(".btn"); 
    
   for(var i=0;i<$btn.length;i++){
       $($btn[i]).click(function(){   
        let $id = $($btn).attr("data-id");
        cart.saveData($id,Number(res),false);
        // localStorage.setItem("shu",JSON.stringify(shu));
        let shu = JSON.parse(localStorage.getItem("shu"));
        // console.log(shu);
       });
     
   }
});
});
</script>
</html>